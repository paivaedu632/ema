{"version":3,"names":["cov_6xk7rwi7z","actualCoverage","NextResponse","CORS_CONFIG","s","origin","process","env","NODE_ENV","b","methods","allowedHeaders","credentials","maxAge","addCorsHeaders","response","f","allowedOrigin","includes","headers","set","join","toString","handleCorsPrelight","request","get","status","undefined","withCors","handler","args","method","isOriginAllowed","getCorsConfig","Object","assign"],"sources":["C:\\Users\\User\\Documents\\GitHub\\ema\\src\\lib\\api\\cors.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\n\n// CORS configuration\nconst CORS_CONFIG = {\n  origin: process.env.NODE_ENV === 'production' \n    ? ['https://your-domain.com'] // Replace with your production domain\n    : ['http://localhost:3000', 'http://127.0.0.1:3000'],\n  methods: ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'],\n  allowedHeaders: [\n    'Content-Type',\n    'Authorization',\n    'X-Requested-With',\n    'Accept',\n    'Origin'\n  ],\n  credentials: true,\n  maxAge: 86400 // 24 hours\n};\n\n/**\n * Add CORS headers to a response\n */\nexport function addCorsHeaders(response: NextResponse, origin?: string): NextResponse {\n  // Check if origin is allowed\n  const allowedOrigin = CORS_CONFIG.origin.includes(origin || '') ? origin : CORS_CONFIG.origin[0];\n\n  response.headers.set('Access-Control-Allow-Origin', allowedOrigin || '*');\n  response.headers.set('Access-Control-Allow-Methods', CORS_CONFIG.methods.join(', '));\n  response.headers.set('Access-Control-Allow-Headers', CORS_CONFIG.allowedHeaders.join(', '));\n  response.headers.set('Access-Control-Allow-Credentials', CORS_CONFIG.credentials.toString());\n  response.headers.set('Access-Control-Max-Age', CORS_CONFIG.maxAge.toString());\n\n  return response;\n}\n\n/**\n * Handle CORS preflight requests\n */\nexport function handleCorsPrelight(request: NextRequest): NextResponse {\n  const origin = request.headers.get('origin');\n  const response = new NextResponse(null, { status: 200 });\n  \n  return addCorsHeaders(response, origin || undefined);\n}\n\n/**\n * Middleware wrapper to add CORS support to API routes\n */\nexport function withCors<T extends unknown[]>(\n  handler: (request: NextRequest, ...args: T) => Promise<NextResponse>\n) {\n  return async (request: NextRequest, ...args: T): Promise<NextResponse> => {\n    const origin = request.headers.get('origin');\n\n    // Handle preflight requests\n    if (request.method === 'OPTIONS') {\n      return handleCorsPrelight(request);\n    }\n\n    // Execute the handler\n    const response = await handler(request, ...args);\n\n    // Add CORS headers to the response\n    return addCorsHeaders(response, origin || undefined);\n  };\n}\n\n/**\n * Check if origin is allowed\n */\nexport function isOriginAllowed(origin: string): boolean {\n  return CORS_CONFIG.origin.includes(origin);\n}\n\n/**\n * Get CORS configuration\n */\nexport function getCorsConfig() {\n  return { ...CORS_CONFIG };\n}\n"],"mappings":"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","ignoreList":[]}