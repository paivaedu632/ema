7d8bac28263fdaa13814ed96ef615cb4
"use strict";
/**
 * Wallet Operations Endpoint Tests
 * Tests for /api/v1/wallets/* endpoints
 */
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const utils_1 = require("../utils");
(0, globals_1.describe)('Wallet Operations Endpoints', () => {
    let testUser;
    let userWithBalance;
    (0, globals_1.beforeAll)(async () => {
        // Create test users
        testUser = await utils_1.testUtils.createUser({
            email: 'wallet-test@emapay.test',
            metadata: { purpose: 'Wallet Testing' }
        });
        // Create user with specific balances
        userWithBalance = await utils_1.testUtils.createUserWithBalance({
            email: 'wallet-balance-test@emapay.test',
            metadata: { purpose: 'Wallet Balance Testing' },
            balances: {
                EUR: { available: 1000.50, reserved: 50.25 },
                AOA: { available: 650000.75, reserved: 25000.00 }
            }
        });
    });
    (0, globals_1.afterAll)(async () => {
        // Clean up test users
        await utils_1.testUtils.cleanup();
    });
    (0, globals_1.describe)('GET /api/v1/wallets/balance - All Balances', () => {
        (0, globals_1.test)('should return all wallet balances for user with balances', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(Array.isArray(balances)).toBe(true);
            (0, globals_1.expect)(balances.length).toBe(2); // EUR and AOA
            // Check EUR balance
            const eurBalance = balances.find((b) => b.currency === 'EUR');
            (0, globals_1.expect)(eurBalance).toBeDefined();
            utils_1.testUtils.assertValidWalletBalance(eurBalance);
            (0, globals_1.expect)(eurBalance.availableBalance).toBe(1000.50);
            (0, globals_1.expect)(eurBalance.reservedBalance).toBe(50.25);
            (0, globals_1.expect)(eurBalance.totalBalance).toBe(1050.75);
            // Check AOA balance
            const aoaBalance = balances.find((b) => b.currency === 'AOA');
            (0, globals_1.expect)(aoaBalance).toBeDefined();
            utils_1.testUtils.assertValidWalletBalance(aoaBalance);
            (0, globals_1.expect)(aoaBalance.availableBalance).toBe(650000.75);
            (0, globals_1.expect)(aoaBalance.reservedBalance).toBe(25000.00);
            (0, globals_1.expect)(aoaBalance.totalBalance).toBe(675000.75);
            // Assert response time
            utils_1.testUtils.assertResponseTime(response, 50);
        });
        (0, globals_1.test)('should return empty balances for new user', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', testUser);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(Array.isArray(balances)).toBe(true);
            (0, globals_1.expect)(balances.length).toBe(2); // Should still return EUR and AOA with zero balances
            balances.forEach((balance) => {
                utils_1.testUtils.assertValidWalletBalance(balance);
                (0, globals_1.expect)(balance.availableBalance).toBe(0);
                (0, globals_1.expect)(balance.reservedBalance).toBe(0);
                (0, globals_1.expect)(balance.totalBalance).toBe(0);
                (0, globals_1.expect)(['EUR', 'AOA']).toContain(balance.currency);
            });
        });
        (0, globals_1.test)('should include all required balance fields', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            balances.forEach((balance) => {
                (0, globals_1.expect)(balance).toHaveProperty('currency');
                (0, globals_1.expect)(balance).toHaveProperty('availableBalance');
                (0, globals_1.expect)(balance).toHaveProperty('reservedBalance');
                (0, globals_1.expect)(balance).toHaveProperty('totalBalance');
                (0, globals_1.expect)(balance).toHaveProperty('lastUpdated');
                // Validate data types
                (0, globals_1.expect)(typeof balance.currency).toBe('string');
                (0, globals_1.expect)(typeof balance.availableBalance).toBe('number');
                (0, globals_1.expect)(typeof balance.reservedBalance).toBe('number');
                (0, globals_1.expect)(typeof balance.totalBalance).toBe('number');
                (0, globals_1.expect)(new Date(balance.lastUpdated)).toBeInstanceOf(Date);
            });
        });
        (0, globals_1.test)('should maintain decimal precision', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            balances.forEach((balance) => {
                utils_1.testUtils.assertDecimalPrecision(balance.availableBalance, 2);
                utils_1.testUtils.assertDecimalPrecision(balance.reservedBalance, 2);
                utils_1.testUtils.assertDecimalPrecision(balance.totalBalance, 2);
            });
        });
        (0, globals_1.test)('should return consistent balance calculations', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            balances.forEach((balance) => {
                const calculatedTotal = balance.availableBalance + balance.reservedBalance;
                (0, globals_1.expect)(balance.totalBalance).toBe(calculatedTotal);
            });
        });
    });
    (0, globals_1.describe)('GET /api/v1/wallets/{currency} - Specific Currency', () => {
        (0, globals_1.test)('should return EUR balance', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/EUR', userWithBalance);
            const balance = utils_1.testUtils.assertSuccessResponse(response, 200);
            utils_1.testUtils.assertValidWalletBalance(balance);
            (0, globals_1.expect)(balance.currency).toBe('EUR');
            (0, globals_1.expect)(balance.availableBalance).toBe(1000.50);
            (0, globals_1.expect)(balance.reservedBalance).toBe(50.25);
            (0, globals_1.expect)(balance.totalBalance).toBe(1050.75);
            utils_1.testUtils.assertResponseTime(response, 50);
        });
        (0, globals_1.test)('should return AOA balance', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/AOA', userWithBalance);
            const balance = utils_1.testUtils.assertSuccessResponse(response, 200);
            utils_1.testUtils.assertValidWalletBalance(balance);
            (0, globals_1.expect)(balance.currency).toBe('AOA');
            (0, globals_1.expect)(balance.availableBalance).toBe(650000.75);
            (0, globals_1.expect)(balance.reservedBalance).toBe(25000.00);
            (0, globals_1.expect)(balance.totalBalance).toBe(675000.75);
        });
        (0, globals_1.test)('should return zero balance for new user', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/EUR', testUser);
            const balance = utils_1.testUtils.assertSuccessResponse(response, 200);
            utils_1.testUtils.assertValidWalletBalance(balance);
            (0, globals_1.expect)(balance.currency).toBe('EUR');
            (0, globals_1.expect)(balance.availableBalance).toBe(0);
            (0, globals_1.expect)(balance.reservedBalance).toBe(0);
            (0, globals_1.expect)(balance.totalBalance).toBe(0);
        });
        (0, globals_1.test)('should return 400 for invalid currency', async () => {
            const invalidCurrencies = ['USD', 'BTC', 'INVALID', '123', 'eur', 'aoa'];
            for (const currency of invalidCurrencies) {
                const response = await utils_1.testUtils.get(`/api/v1/wallets/${currency}`, testUser);
                utils_1.testUtils.assertErrorResponse(response, 400);
                (0, globals_1.expect)(response.body.error).toContain('currency');
            }
        });
        (0, globals_1.test)('should handle case sensitivity for currency', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/eur', testUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('currency');
        });
        (0, globals_1.test)('should return 404 for non-existent currency endpoint', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/NONEXISTENT', testUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
        });
    });
    (0, globals_1.describe)('Wallet Balance Edge Cases', () => {
        (0, globals_1.test)('should handle very small amounts', async () => {
            const userWithSmallBalance = await utils_1.testUtils.createUserWithBalance({
                email: 'small-balance@emapay.test',
                balances: {
                    EUR: { available: 0.01, reserved: 0.01 }
                }
            });
            const response = await utils_1.testUtils.get('/api/v1/wallets/EUR', userWithSmallBalance);
            const balance = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(balance.availableBalance).toBe(0.01);
            (0, globals_1.expect)(balance.reservedBalance).toBe(0.01);
            (0, globals_1.expect)(balance.totalBalance).toBe(0.02);
        });
        (0, globals_1.test)('should handle large amounts', async () => {
            const userWithLargeBalance = await utils_1.testUtils.createUserWithBalance({
                email: 'large-balance@emapay.test',
                balances: {
                    AOA: { available: 999999999.99, reserved: 0 }
                }
            });
            const response = await utils_1.testUtils.get('/api/v1/wallets/AOA', userWithLargeBalance);
            const balance = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(balance.availableBalance).toBe(999999999.99);
            (0, globals_1.expect)(balance.reservedBalance).toBe(0);
            (0, globals_1.expect)(balance.totalBalance).toBe(999999999.99);
        });
        (0, globals_1.test)('should handle zero balances correctly', async () => {
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', testUser);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            balances.forEach((balance) => {
                (0, globals_1.expect)(balance.availableBalance).toBe(0);
                (0, globals_1.expect)(balance.reservedBalance).toBe(0);
                (0, globals_1.expect)(balance.totalBalance).toBe(0);
            });
        });
        (0, globals_1.test)('should handle reserved balance scenarios', async () => {
            const userWithReservedBalance = await utils_1.testUtils.createUserWithBalance({
                email: 'reserved-balance@emapay.test',
                balances: {
                    EUR: { available: 100, reserved: 900 }
                }
            });
            const response = await utils_1.testUtils.get('/api/v1/wallets/EUR', userWithReservedBalance);
            const balance = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(balance.availableBalance).toBe(100);
            (0, globals_1.expect)(balance.reservedBalance).toBe(900);
            (0, globals_1.expect)(balance.totalBalance).toBe(1000);
        });
        (0, globals_1.test)('should not allow negative balances', async () => {
            // This test verifies that the system doesn't return negative balances
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', testUser);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            balances.forEach((balance) => {
                (0, globals_1.expect)(balance.availableBalance).toBeGreaterThanOrEqual(0);
                (0, globals_1.expect)(balance.reservedBalance).toBeGreaterThanOrEqual(0);
                (0, globals_1.expect)(balance.totalBalance).toBeGreaterThanOrEqual(0);
            });
        });
    });
    (0, globals_1.describe)('Wallet Authorization', () => {
        (0, globals_1.test)('should require authentication for balance endpoint', async () => {
            const response = await utils_1.testUtils.publicGet('/api/v1/wallets/balance');
            utils_1.testUtils.assertErrorResponse(response, 401);
            (0, globals_1.expect)(response.body.error).toContain('authorization');
        });
        (0, globals_1.test)('should require authentication for currency endpoint', async () => {
            const response = await utils_1.testUtils.publicGet('/api/v1/wallets/EUR');
            utils_1.testUtils.assertErrorResponse(response, 401);
            (0, globals_1.expect)(response.body.error).toContain('authorization');
        });
        (0, globals_1.test)('should reject invalid JWT tokens', async () => {
            const response = await utils_1.testUtils.testWithInvalidToken('GET', '/api/v1/wallets/balance');
            utils_1.testUtils.assertErrorResponse(response, 401);
            (0, globals_1.expect)(response.body.error).toContain('token');
        });
        (0, globals_1.test)('should reject expired JWT tokens', async () => {
            const response = await utils_1.testUtils.testWithExpiredToken('GET', '/api/v1/wallets/EUR');
            utils_1.testUtils.assertErrorResponse(response, 401);
            (0, globals_1.expect)(response.body.error).toContain('expired');
        });
        (0, globals_1.test)('should only return own wallet data', async () => {
            // User should only see their own balances, not other users' balances
            const response = await utils_1.testUtils.get('/api/v1/wallets/balance', testUser);
            const balances = utils_1.testUtils.assertSuccessResponse(response, 200);
            // Should return zero balances for testUser, not userWithBalance's balances
            balances.forEach((balance) => {
                (0, globals_1.expect)(balance.availableBalance).toBe(0);
                (0, globals_1.expect)(balance.reservedBalance).toBe(0);
                (0, globals_1.expect)(balance.totalBalance).toBe(0);
            });
        });
    });
    (0, globals_1.describe)('Wallet Performance', () => {
        (0, globals_1.test)('should respond within 50ms for balance endpoint', async () => {
            const { response, passed } = await utils_1.testUtils.testPerformance('GET', '/api/v1/wallets/balance', 50, userWithBalance);
            (0, globals_1.expect)(passed).toBe(true);
            utils_1.testUtils.assertSuccessResponse(response, 200);
        });
        (0, globals_1.test)('should respond within 50ms for currency endpoint', async () => {
            const { response, passed } = await utils_1.testUtils.testPerformance('GET', '/api/v1/wallets/EUR', 50, userWithBalance);
            (0, globals_1.expect)(passed).toBe(true);
            utils_1.testUtils.assertSuccessResponse(response, 200);
        });
        (0, globals_1.test)('should handle concurrent balance requests', async () => {
            const responses = await utils_1.testUtils.testConcurrency('GET', '/api/v1/wallets/balance', 10, userWithBalance);
            (0, globals_1.expect)(responses).toHaveLength(10);
            responses.forEach(response => {
                utils_1.testUtils.assertSuccessResponse(response, 200);
                utils_1.testUtils.assertResponseTime(response, 100); // Allow more time for concurrent requests
            });
        });
        (0, globals_1.test)('should handle concurrent currency requests', async () => {
            const responses = await utils_1.testUtils.testConcurrency('GET', '/api/v1/wallets/EUR', 10, userWithBalance);
            (0, globals_1.expect)(responses).toHaveLength(10);
            responses.forEach(response => {
                utils_1.testUtils.assertSuccessResponse(response, 200);
                utils_1.testUtils.assertResponseTime(response, 100);
            });
        });
        (0, globals_1.test)('should maintain performance with multiple currencies', async () => {
            const currencies = ['EUR', 'AOA'];
            for (const currency of currencies) {
                const { response, passed } = await utils_1.testUtils.testPerformance('GET', `/api/v1/wallets/${currency}`, 50, userWithBalance);
                (0, globals_1.expect)(passed).toBe(true);
                utils_1.testUtils.assertSuccessResponse(response, 200);
            }
        });
        (0, globals_1.test)('should cache balance data for better performance', async () => {
            // First request
            const start1 = Date.now();
            const response1 = await utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance);
            const time1 = Date.now() - start1;
            utils_1.testUtils.assertSuccessResponse(response1, 200);
            // Second request (should be faster due to caching)
            const start2 = Date.now();
            const response2 = await utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance);
            const time2 = Date.now() - start2;
            utils_1.testUtils.assertSuccessResponse(response2, 200);
            // Second request should be faster (or at least not significantly slower)
            (0, globals_1.expect)(time2).toBeLessThanOrEqual(time1 * 1.5);
            // Results should be identical
            (0, globals_1.expect)(response1.body).toEqual(response2.body);
        });
        (0, globals_1.test)('should handle rapid successive requests', async () => {
            const promises = [];
            // Make 20 rapid requests
            for (let i = 0; i < 20; i++) {
                promises.push(utils_1.testUtils.get('/api/v1/wallets/EUR', userWithBalance));
            }
            const responses = await Promise.all(promises);
            responses.forEach(response => {
                utils_1.testUtils.assertSuccessResponse(response, 200);
                utils_1.testUtils.assertResponseTime(response, 100);
            });
            // All responses should be identical
            const firstResponse = responses[0].body;
            responses.forEach(response => {
                (0, globals_1.expect)(response.body).toEqual(firstResponse);
            });
        });
        (0, globals_1.test)('should maintain performance under mixed load', async () => {
            const promises = [];
            // Mix of balance and currency requests
            for (let i = 0; i < 10; i++) {
                promises.push(utils_1.testUtils.get('/api/v1/wallets/balance', userWithBalance));
                promises.push(utils_1.testUtils.get('/api/v1/wallets/EUR', userWithBalance));
                promises.push(utils_1.testUtils.get('/api/v1/wallets/AOA', userWithBalance));
            }
            const responses = await Promise.all(promises);
            responses.forEach(response => {
                utils_1.testUtils.assertSuccessResponse(response, 200);
                utils_1.testUtils.assertResponseTime(response, 150); // Allow more time for mixed load
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxVc2VyXFxEb2N1bWVudHNcXEdpdEh1YlxcZW1hXFx0ZXN0c1xcdW5pdFxcd2FsbGV0cy50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7O0FBRUgsMkNBQXdGO0FBQ3hGLG9DQUErQztBQUUvQyxJQUFBLGtCQUFRLEVBQUMsNkJBQTZCLEVBQUUsR0FBRyxFQUFFO0lBQzNDLElBQUksUUFBa0IsQ0FBQztJQUN2QixJQUFJLGVBQXlCLENBQUM7SUFFOUIsSUFBQSxtQkFBUyxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQ25CLG9CQUFvQjtRQUNwQixRQUFRLEdBQUcsTUFBTSxpQkFBUyxDQUFDLFVBQVUsQ0FBQztZQUNwQyxLQUFLLEVBQUUseUJBQXlCO1lBQ2hDLFFBQVEsRUFBRSxFQUFFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRTtTQUN4QyxDQUFDLENBQUM7UUFFSCxxQ0FBcUM7UUFDckMsZUFBZSxHQUFHLE1BQU0saUJBQVMsQ0FBQyxxQkFBcUIsQ0FBQztZQUN0RCxLQUFLLEVBQUUsaUNBQWlDO1lBQ3hDLFFBQVEsRUFBRSxFQUFFLE9BQU8sRUFBRSx3QkFBd0IsRUFBRTtZQUMvQyxRQUFRLEVBQUU7Z0JBQ1IsR0FBRyxFQUFFLEVBQUUsU0FBUyxFQUFFLE9BQU8sRUFBRSxRQUFRLEVBQUUsS0FBSyxFQUFFO2dCQUM1QyxHQUFHLEVBQUUsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUU7YUFDbEQ7U0FDRixDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUEsa0JBQVEsRUFBQyxLQUFLLElBQUksRUFBRTtRQUNsQixzQkFBc0I7UUFDdEIsTUFBTSxpQkFBUyxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQzVCLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBQSxrQkFBUSxFQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtRQUMxRCxJQUFBLGNBQUksRUFBQywwREFBMEQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMxRSxN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RG9jdW1lbnRzXFxHaXRIdWJcXGVtYVxcdGVzdHNcXHVuaXRcXHdhbGxldHMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFdhbGxldCBPcGVyYXRpb25zIEVuZHBvaW50IFRlc3RzXG4gKiBUZXN0cyBmb3IgL2FwaS92MS93YWxsZXRzLyogZW5kcG9pbnRzXG4gKi9cblxuaW1wb3J0IHsgZGVzY3JpYmUsIHRlc3QsIGV4cGVjdCwgYmVmb3JlQWxsLCBhZnRlckFsbCwgYmVmb3JlRWFjaCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgdGVzdFV0aWxzLCBUZXN0VXNlciB9IGZyb20gJy4uL3V0aWxzJztcblxuZGVzY3JpYmUoJ1dhbGxldCBPcGVyYXRpb25zIEVuZHBvaW50cycsICgpID0+IHtcbiAgbGV0IHRlc3RVc2VyOiBUZXN0VXNlcjtcbiAgbGV0IHVzZXJXaXRoQmFsYW5jZTogVGVzdFVzZXI7XG5cbiAgYmVmb3JlQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBDcmVhdGUgdGVzdCB1c2Vyc1xuICAgIHRlc3RVc2VyID0gYXdhaXQgdGVzdFV0aWxzLmNyZWF0ZVVzZXIoe1xuICAgICAgZW1haWw6ICd3YWxsZXQtdGVzdEBlbWFwYXkudGVzdCcsXG4gICAgICBtZXRhZGF0YTogeyBwdXJwb3NlOiAnV2FsbGV0IFRlc3RpbmcnIH1cbiAgICB9KTtcblxuICAgIC8vIENyZWF0ZSB1c2VyIHdpdGggc3BlY2lmaWMgYmFsYW5jZXNcbiAgICB1c2VyV2l0aEJhbGFuY2UgPSBhd2FpdCB0ZXN0VXRpbHMuY3JlYXRlVXNlcldpdGhCYWxhbmNlKHtcbiAgICAgIGVtYWlsOiAnd2FsbGV0LWJhbGFuY2UtdGVzdEBlbWFwYXkudGVzdCcsXG4gICAgICBtZXRhZGF0YTogeyBwdXJwb3NlOiAnV2FsbGV0IEJhbGFuY2UgVGVzdGluZycgfSxcbiAgICAgIGJhbGFuY2VzOiB7XG4gICAgICAgIEVVUjogeyBhdmFpbGFibGU6IDEwMDAuNTAsIHJlc2VydmVkOiA1MC4yNSB9LFxuICAgICAgICBBT0E6IHsgYXZhaWxhYmxlOiA2NTAwMDAuNzUsIHJlc2VydmVkOiAyNTAwMC4wMCB9XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuXG4gIGFmdGVyQWxsKGFzeW5jICgpID0+IHtcbiAgICAvLyBDbGVhbiB1cCB0ZXN0IHVzZXJzXG4gICAgYXdhaXQgdGVzdFV0aWxzLmNsZWFudXAoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL3YxL3dhbGxldHMvYmFsYW5jZSAtIEFsbCBCYWxhbmNlcycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIGFsbCB3YWxsZXQgYmFsYW5jZXMgZm9yIHVzZXIgd2l0aCBiYWxhbmNlcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL2JhbGFuY2UnLCB1c2VyV2l0aEJhbGFuY2UpO1xuICAgICAgXG4gICAgICBjb25zdCBiYWxhbmNlcyA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGJhbGFuY2VzKSkudG9CZSh0cnVlKTtcbiAgICAgIGV4cGVjdChiYWxhbmNlcy5sZW5ndGgpLnRvQmUoMik7IC8vIEVVUiBhbmQgQU9BXG4gICAgICBcbiAgICAgIC8vIENoZWNrIEVVUiBiYWxhbmNlXG4gICAgICBjb25zdCBldXJCYWxhbmNlID0gYmFsYW5jZXMuZmluZCgoYjogYW55KSA9PiBiLmN1cnJlbmN5ID09PSAnRVVSJyk7XG4gICAgICBleHBlY3QoZXVyQmFsYW5jZSkudG9CZURlZmluZWQoKTtcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRWYWxpZFdhbGxldEJhbGFuY2UoZXVyQmFsYW5jZSk7XG4gICAgICBleHBlY3QoZXVyQmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlKS50b0JlKDEwMDAuNTApO1xuICAgICAgZXhwZWN0KGV1ckJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlKS50b0JlKDUwLjI1KTtcbiAgICAgIGV4cGVjdChldXJCYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZSgxMDUwLjc1KTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgQU9BIGJhbGFuY2VcbiAgICAgIGNvbnN0IGFvYUJhbGFuY2UgPSBiYWxhbmNlcy5maW5kKChiOiBhbnkpID0+IGIuY3VycmVuY3kgPT09ICdBT0EnKTtcbiAgICAgIGV4cGVjdChhb2FCYWxhbmNlKS50b0JlRGVmaW5lZCgpO1xuICAgICAgdGVzdFV0aWxzLmFzc2VydFZhbGlkV2FsbGV0QmFsYW5jZShhb2FCYWxhbmNlKTtcbiAgICAgIGV4cGVjdChhb2FCYWxhbmNlLmF2YWlsYWJsZUJhbGFuY2UpLnRvQmUoNjUwMDAwLjc1KTtcbiAgICAgIGV4cGVjdChhb2FCYWxhbmNlLnJlc2VydmVkQmFsYW5jZSkudG9CZSgyNTAwMC4wMCk7XG4gICAgICBleHBlY3QoYW9hQmFsYW5jZS50b3RhbEJhbGFuY2UpLnRvQmUoNjc1MDAwLjc1KTtcbiAgICAgIFxuICAgICAgLy8gQXNzZXJ0IHJlc3BvbnNlIHRpbWVcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRSZXNwb25zZVRpbWUocmVzcG9uc2UsIDUwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYmFsYW5jZXMgZm9yIG5ldyB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvYmFsYW5jZScsIHRlc3RVc2VyKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZXMgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICBleHBlY3QoQXJyYXkuaXNBcnJheShiYWxhbmNlcykpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QoYmFsYW5jZXMubGVuZ3RoKS50b0JlKDIpOyAvLyBTaG91bGQgc3RpbGwgcmV0dXJuIEVVUiBhbmQgQU9BIHdpdGggemVybyBiYWxhbmNlc1xuICAgICAgXG4gICAgICBiYWxhbmNlcy5mb3JFYWNoKChiYWxhbmNlOiBhbnkpID0+IHtcbiAgICAgICAgdGVzdFV0aWxzLmFzc2VydFZhbGlkV2FsbGV0QmFsYW5jZShiYWxhbmNlKTtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSkudG9CZSgwKTtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlKS50b0JlKDApO1xuICAgICAgICBleHBlY3QoYmFsYW5jZS50b3RhbEJhbGFuY2UpLnRvQmUoMCk7XG4gICAgICAgIGV4cGVjdChbJ0VVUicsICdBT0EnXSkudG9Db250YWluKGJhbGFuY2UuY3VycmVuY3kpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaW5jbHVkZSBhbGwgcmVxdWlyZWQgYmFsYW5jZSBmaWVsZHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJywgdXNlcldpdGhCYWxhbmNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZXMgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICBiYWxhbmNlcy5mb3JFYWNoKChiYWxhbmNlOiBhbnkpID0+IHtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UpLnRvSGF2ZVByb3BlcnR5KCdjdXJyZW5jeScpO1xuICAgICAgICBleHBlY3QoYmFsYW5jZSkudG9IYXZlUHJvcGVydHkoJ2F2YWlsYWJsZUJhbGFuY2UnKTtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UpLnRvSGF2ZVByb3BlcnR5KCdyZXNlcnZlZEJhbGFuY2UnKTtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UpLnRvSGF2ZVByb3BlcnR5KCd0b3RhbEJhbGFuY2UnKTtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UpLnRvSGF2ZVByb3BlcnR5KCdsYXN0VXBkYXRlZCcpO1xuICAgICAgICBcbiAgICAgICAgLy8gVmFsaWRhdGUgZGF0YSB0eXBlc1xuICAgICAgICBleHBlY3QodHlwZW9mIGJhbGFuY2UuY3VycmVuY3kpLnRvQmUoJ3N0cmluZycpO1xuICAgICAgICBleHBlY3QodHlwZW9mIGJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSkudG9CZSgnbnVtYmVyJyk7XG4gICAgICAgIGV4cGVjdCh0eXBlb2YgYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2UpLnRvQmUoJ251bWJlcicpO1xuICAgICAgICBleHBlY3QodHlwZW9mIGJhbGFuY2UudG90YWxCYWxhbmNlKS50b0JlKCdudW1iZXInKTtcbiAgICAgICAgZXhwZWN0KG5ldyBEYXRlKGJhbGFuY2UubGFzdFVwZGF0ZWQpKS50b0JlSW5zdGFuY2VPZihEYXRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIG1haW50YWluIGRlY2ltYWwgcHJlY2lzaW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvYmFsYW5jZScsIHVzZXJXaXRoQmFsYW5jZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGJhbGFuY2VzID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcbiAgICAgIFxuICAgICAgYmFsYW5jZXMuZm9yRWFjaCgoYmFsYW5jZTogYW55KSA9PiB7XG4gICAgICAgIHRlc3RVdGlscy5hc3NlcnREZWNpbWFsUHJlY2lzaW9uKGJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSwgMik7XG4gICAgICAgIHRlc3RVdGlscy5hc3NlcnREZWNpbWFsUHJlY2lzaW9uKGJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlLCAyKTtcbiAgICAgICAgdGVzdFV0aWxzLmFzc2VydERlY2ltYWxQcmVjaXNpb24oYmFsYW5jZS50b3RhbEJhbGFuY2UsIDIpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIGNvbnNpc3RlbnQgYmFsYW5jZSBjYWxjdWxhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJywgdXNlcldpdGhCYWxhbmNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZXMgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICBiYWxhbmNlcy5mb3JFYWNoKChiYWxhbmNlOiBhbnkpID0+IHtcbiAgICAgICAgY29uc3QgY2FsY3VsYXRlZFRvdGFsID0gYmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlICsgYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2U7XG4gICAgICAgIGV4cGVjdChiYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZShjYWxjdWxhdGVkVG90YWwpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdHRVQgL2FwaS92MS93YWxsZXRzL3tjdXJyZW5jeX0gLSBTcGVjaWZpYyBDdXJyZW5jeScsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIEVVUiBiYWxhbmNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvRVVSJywgdXNlcldpdGhCYWxhbmNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRWYWxpZFdhbGxldEJhbGFuY2UoYmFsYW5jZSk7XG4gICAgICBleHBlY3QoYmFsYW5jZS5jdXJyZW5jeSkudG9CZSgnRVVSJyk7XG4gICAgICBleHBlY3QoYmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlKS50b0JlKDEwMDAuNTApO1xuICAgICAgZXhwZWN0KGJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlKS50b0JlKDUwLjI1KTtcbiAgICAgIGV4cGVjdChiYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZSgxMDUwLjc1KTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydFJlc3BvbnNlVGltZShyZXNwb25zZSwgNTApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJldHVybiBBT0EgYmFsYW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0FPQScsIHVzZXJXaXRoQmFsYW5jZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGJhbGFuY2UgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0VmFsaWRXYWxsZXRCYWxhbmNlKGJhbGFuY2UpO1xuICAgICAgZXhwZWN0KGJhbGFuY2UuY3VycmVuY3kpLnRvQmUoJ0FPQScpO1xuICAgICAgZXhwZWN0KGJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSkudG9CZSg2NTAwMDAuNzUpO1xuICAgICAgZXhwZWN0KGJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlKS50b0JlKDI1MDAwLjAwKTtcbiAgICAgIGV4cGVjdChiYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZSg2NzUwMDAuNzUpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJldHVybiB6ZXJvIGJhbGFuY2UgZm9yIG5ldyB1c2VyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvRVVSJywgdGVzdFVzZXIpO1xuICAgICAgXG4gICAgICBjb25zdCBiYWxhbmNlID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydFZhbGlkV2FsbGV0QmFsYW5jZShiYWxhbmNlKTtcbiAgICAgIGV4cGVjdChiYWxhbmNlLmN1cnJlbmN5KS50b0JlKCdFVVInKTtcbiAgICAgIGV4cGVjdChiYWxhbmNlLmF2YWlsYWJsZUJhbGFuY2UpLnRvQmUoMCk7XG4gICAgICBleHBlY3QoYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2UpLnRvQmUoMCk7XG4gICAgICBleHBlY3QoYmFsYW5jZS50b3RhbEJhbGFuY2UpLnRvQmUoMCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIDQwMCBmb3IgaW52YWxpZCBjdXJyZW5jeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRDdXJyZW5jaWVzID0gWydVU0QnLCAnQlRDJywgJ0lOVkFMSUQnLCAnMTIzJywgJ2V1cicsICdhb2EnXTtcbiAgICAgIFxuICAgICAgZm9yIChjb25zdCBjdXJyZW5jeSBvZiBpbnZhbGlkQ3VycmVuY2llcykge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoYC9hcGkvdjEvd2FsbGV0cy8ke2N1cnJlbmN5fWAsIHRlc3RVc2VyKTtcbiAgICAgICAgXG4gICAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDApO1xuICAgICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9Db250YWluKCdjdXJyZW5jeScpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBjYXNlIHNlbnNpdGl2aXR5IGZvciBjdXJyZW5jeScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL2V1cicsIHRlc3RVc2VyKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9Db250YWluKCdjdXJyZW5jeScpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJldHVybiA0MDQgZm9yIG5vbi1leGlzdGVudCBjdXJyZW5jeSBlbmRwb2ludCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL05PTkVYSVNURU5UJywgdGVzdFVzZXIpO1xuICAgICAgXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0RXJyb3JSZXNwb25zZShyZXNwb25zZSwgNDAwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1dhbGxldCBCYWxhbmNlIEVkZ2UgQ2FzZXMnLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSB2ZXJ5IHNtYWxsIGFtb3VudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VyV2l0aFNtYWxsQmFsYW5jZSA9IGF3YWl0IHRlc3RVdGlscy5jcmVhdGVVc2VyV2l0aEJhbGFuY2Uoe1xuICAgICAgICBlbWFpbDogJ3NtYWxsLWJhbGFuY2VAZW1hcGF5LnRlc3QnLFxuICAgICAgICBiYWxhbmNlczoge1xuICAgICAgICAgIEVVUjogeyBhdmFpbGFibGU6IDAuMDEsIHJlc2VydmVkOiAwLjAxIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0VVUicsIHVzZXJXaXRoU21hbGxCYWxhbmNlKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG4gICAgICBcbiAgICAgIGV4cGVjdChiYWxhbmNlLmF2YWlsYWJsZUJhbGFuY2UpLnRvQmUoMC4wMSk7XG4gICAgICBleHBlY3QoYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2UpLnRvQmUoMC4wMSk7XG4gICAgICBleHBlY3QoYmFsYW5jZS50b3RhbEJhbGFuY2UpLnRvQmUoMC4wMik7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGxhcmdlIGFtb3VudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VyV2l0aExhcmdlQmFsYW5jZSA9IGF3YWl0IHRlc3RVdGlscy5jcmVhdGVVc2VyV2l0aEJhbGFuY2Uoe1xuICAgICAgICBlbWFpbDogJ2xhcmdlLWJhbGFuY2VAZW1hcGF5LnRlc3QnLFxuICAgICAgICBiYWxhbmNlczoge1xuICAgICAgICAgIEFPQTogeyBhdmFpbGFibGU6IDk5OTk5OTk5OS45OSwgcmVzZXJ2ZWQ6IDAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvQU9BJywgdXNlcldpdGhMYXJnZUJhbGFuY2UpO1xuICAgICAgXG4gICAgICBjb25zdCBiYWxhbmNlID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KGJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSkudG9CZSg5OTk5OTk5OTkuOTkpO1xuICAgICAgZXhwZWN0KGJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlKS50b0JlKDApO1xuICAgICAgZXhwZWN0KGJhbGFuY2UudG90YWxCYWxhbmNlKS50b0JlKDk5OTk5OTk5OS45OSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIHplcm8gYmFsYW5jZXMgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvYmFsYW5jZScsIHRlc3RVc2VyKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZXMgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICBiYWxhbmNlcy5mb3JFYWNoKChiYWxhbmNlOiBhbnkpID0+IHtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSkudG9CZSgwKTtcbiAgICAgICAgZXhwZWN0KGJhbGFuY2UucmVzZXJ2ZWRCYWxhbmNlKS50b0JlKDApO1xuICAgICAgICBleHBlY3QoYmFsYW5jZS50b3RhbEJhbGFuY2UpLnRvQmUoMCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgcmVzZXJ2ZWQgYmFsYW5jZSBzY2VuYXJpb3MnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB1c2VyV2l0aFJlc2VydmVkQmFsYW5jZSA9IGF3YWl0IHRlc3RVdGlscy5jcmVhdGVVc2VyV2l0aEJhbGFuY2Uoe1xuICAgICAgICBlbWFpbDogJ3Jlc2VydmVkLWJhbGFuY2VAZW1hcGF5LnRlc3QnLFxuICAgICAgICBiYWxhbmNlczoge1xuICAgICAgICAgIEVVUjogeyBhdmFpbGFibGU6IDEwMCwgcmVzZXJ2ZWQ6IDkwMCB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9FVVInLCB1c2VyV2l0aFJlc2VydmVkQmFsYW5jZSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGJhbGFuY2UgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICBleHBlY3QoYmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlKS50b0JlKDEwMCk7XG4gICAgICBleHBlY3QoYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2UpLnRvQmUoOTAwKTtcbiAgICAgIGV4cGVjdChiYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZSgxMDAwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBub3QgYWxsb3cgbmVnYXRpdmUgYmFsYW5jZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBUaGlzIHRlc3QgdmVyaWZpZXMgdGhhdCB0aGUgc3lzdGVtIGRvZXNuJ3QgcmV0dXJuIG5lZ2F0aXZlIGJhbGFuY2VzXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJywgdGVzdFVzZXIpO1xuICAgICAgXG4gICAgICBjb25zdCBiYWxhbmNlcyA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG4gICAgICBcbiAgICAgIGJhbGFuY2VzLmZvckVhY2goKGJhbGFuY2U6IGFueSkgPT4ge1xuICAgICAgICBleHBlY3QoYmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlKS50b0JlR3JlYXRlclRoYW5PckVxdWFsKDApO1xuICAgICAgICBleHBlY3QoYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2UpLnRvQmVHcmVhdGVyVGhhbk9yRXF1YWwoMCk7XG4gICAgICAgIGV4cGVjdChiYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnV2FsbGV0IEF1dGhvcml6YXRpb24nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIHJlcXVpcmUgYXV0aGVudGljYXRpb24gZm9yIGJhbGFuY2UgZW5kcG9pbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wdWJsaWNHZXQoJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJyk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDEpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignYXV0aG9yaXphdGlvbicpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlcXVpcmUgYXV0aGVudGljYXRpb24gZm9yIGN1cnJlbmN5IGVuZHBvaW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucHVibGljR2V0KCcvYXBpL3YxL3dhbGxldHMvRVVSJyk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDEpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignYXV0aG9yaXphdGlvbicpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlamVjdCBpbnZhbGlkIEpXVCB0b2tlbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy50ZXN0V2l0aEludmFsaWRUb2tlbignR0VUJywgJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJyk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDEpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbigndG9rZW4nKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgZXhwaXJlZCBKV1QgdG9rZW5zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMudGVzdFdpdGhFeHBpcmVkVG9rZW4oJ0dFVCcsICcvYXBpL3YxL3dhbGxldHMvRVVSJyk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDEpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignZXhwaXJlZCcpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIG9ubHkgcmV0dXJuIG93biB3YWxsZXQgZGF0YScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIFVzZXIgc2hvdWxkIG9ubHkgc2VlIHRoZWlyIG93biBiYWxhbmNlcywgbm90IG90aGVyIHVzZXJzJyBiYWxhbmNlc1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvYmFsYW5jZScsIHRlc3RVc2VyKTtcbiAgICAgIFxuICAgICAgY29uc3QgYmFsYW5jZXMgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgXG4gICAgICAvLyBTaG91bGQgcmV0dXJuIHplcm8gYmFsYW5jZXMgZm9yIHRlc3RVc2VyLCBub3QgdXNlcldpdGhCYWxhbmNlJ3MgYmFsYW5jZXNcbiAgICAgIGJhbGFuY2VzLmZvckVhY2goKGJhbGFuY2U6IGFueSkgPT4ge1xuICAgICAgICBleHBlY3QoYmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlKS50b0JlKDApO1xuICAgICAgICBleHBlY3QoYmFsYW5jZS5yZXNlcnZlZEJhbGFuY2UpLnRvQmUoMCk7XG4gICAgICAgIGV4cGVjdChiYWxhbmNlLnRvdGFsQmFsYW5jZSkudG9CZSgwKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnV2FsbGV0IFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCByZXNwb25kIHdpdGhpbiA1MG1zIGZvciBiYWxhbmNlIGVuZHBvaW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXNwb25zZSwgcGFzc2VkIH0gPSBhd2FpdCB0ZXN0VXRpbHMudGVzdFBlcmZvcm1hbmNlKFxuICAgICAgICAnR0VUJyxcbiAgICAgICAgJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJyxcbiAgICAgICAgNTAsXG4gICAgICAgIHVzZXJXaXRoQmFsYW5jZVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHBhc3NlZCkudG9CZSh0cnVlKTtcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVzcG9uZCB3aXRoaW4gNTBtcyBmb3IgY3VycmVuY3kgZW5kcG9pbnQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB7IHJlc3BvbnNlLCBwYXNzZWQgfSA9IGF3YWl0IHRlc3RVdGlscy50ZXN0UGVyZm9ybWFuY2UoXG4gICAgICAgICdHRVQnLFxuICAgICAgICAnL2FwaS92MS93YWxsZXRzL0VVUicsXG4gICAgICAgIDUwLFxuICAgICAgICB1c2VyV2l0aEJhbGFuY2VcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwYXNzZWQpLnRvQmUodHJ1ZSk7XG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGJhbGFuY2UgcmVxdWVzdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCB0ZXN0VXRpbHMudGVzdENvbmN1cnJlbmN5KFxuICAgICAgICAnR0VUJyxcbiAgICAgICAgJy9hcGkvdjEvd2FsbGV0cy9iYWxhbmNlJyxcbiAgICAgICAgMTAsXG4gICAgICAgIHVzZXJXaXRoQmFsYW5jZVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlcykudG9IYXZlTGVuZ3RoKDEwKTtcblxuICAgICAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xuICAgICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgICB0ZXN0VXRpbHMuYXNzZXJ0UmVzcG9uc2VUaW1lKHJlc3BvbnNlLCAxMDApOyAvLyBBbGxvdyBtb3JlIHRpbWUgZm9yIGNvbmN1cnJlbnQgcmVxdWVzdHNcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IGN1cnJlbmN5IHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2VzID0gYXdhaXQgdGVzdFV0aWxzLnRlc3RDb25jdXJyZW5jeShcbiAgICAgICAgJ0dFVCcsXG4gICAgICAgICcvYXBpL3YxL3dhbGxldHMvRVVSJyxcbiAgICAgICAgMTAsXG4gICAgICAgIHVzZXJXaXRoQmFsYW5jZVxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHJlc3BvbnNlcykudG9IYXZlTGVuZ3RoKDEwKTtcblxuICAgICAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xuICAgICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgICB0ZXN0VXRpbHMuYXNzZXJ0UmVzcG9uc2VUaW1lKHJlc3BvbnNlLCAxMDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgbWFpbnRhaW4gcGVyZm9ybWFuY2Ugd2l0aCBtdWx0aXBsZSBjdXJyZW5jaWVzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY3VycmVuY2llcyA9IFsnRVVSJywgJ0FPQSddO1xuXG4gICAgICBmb3IgKGNvbnN0IGN1cnJlbmN5IG9mIGN1cnJlbmNpZXMpIHtcbiAgICAgICAgY29uc3QgeyByZXNwb25zZSwgcGFzc2VkIH0gPSBhd2FpdCB0ZXN0VXRpbHMudGVzdFBlcmZvcm1hbmNlKFxuICAgICAgICAgICdHRVQnLFxuICAgICAgICAgIGAvYXBpL3YxL3dhbGxldHMvJHtjdXJyZW5jeX1gLFxuICAgICAgICAgIDUwLFxuICAgICAgICAgIHVzZXJXaXRoQmFsYW5jZVxuICAgICAgICApO1xuXG4gICAgICAgIGV4cGVjdChwYXNzZWQpLnRvQmUodHJ1ZSk7XG4gICAgICAgIHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgY2FjaGUgYmFsYW5jZSBkYXRhIGZvciBiZXR0ZXIgcGVyZm9ybWFuY2UnLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBGaXJzdCByZXF1ZXN0XG4gICAgICBjb25zdCBzdGFydDEgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVzcG9uc2UxID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL2JhbGFuY2UnLCB1c2VyV2l0aEJhbGFuY2UpO1xuICAgICAgY29uc3QgdGltZTEgPSBEYXRlLm5vdygpIC0gc3RhcnQxO1xuXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlMSwgMjAwKTtcblxuICAgICAgLy8gU2Vjb25kIHJlcXVlc3QgKHNob3VsZCBiZSBmYXN0ZXIgZHVlIHRvIGNhY2hpbmcpXG4gICAgICBjb25zdCBzdGFydDIgPSBEYXRlLm5vdygpO1xuICAgICAgY29uc3QgcmVzcG9uc2UyID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL2JhbGFuY2UnLCB1c2VyV2l0aEJhbGFuY2UpO1xuICAgICAgY29uc3QgdGltZTIgPSBEYXRlLm5vdygpIC0gc3RhcnQyO1xuXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlMiwgMjAwKTtcblxuICAgICAgLy8gU2Vjb25kIHJlcXVlc3Qgc2hvdWxkIGJlIGZhc3RlciAob3IgYXQgbGVhc3Qgbm90IHNpZ25pZmljYW50bHkgc2xvd2VyKVxuICAgICAgZXhwZWN0KHRpbWUyKS50b0JlTGVzc1RoYW5PckVxdWFsKHRpbWUxICogMS41KTtcblxuICAgICAgLy8gUmVzdWx0cyBzaG91bGQgYmUgaWRlbnRpY2FsXG4gICAgICBleHBlY3QocmVzcG9uc2UxLmJvZHkpLnRvRXF1YWwocmVzcG9uc2UyLmJvZHkpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSByYXBpZCBzdWNjZXNzaXZlIHJlcXVlc3RzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcblxuICAgICAgLy8gTWFrZSAyMCByYXBpZCByZXF1ZXN0c1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAyMDsgaSsrKSB7XG4gICAgICAgIHByb21pc2VzLnB1c2godGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0VVUicsIHVzZXJXaXRoQmFsYW5jZSkpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cbiAgICAgIHJlc3BvbnNlcy5mb3JFYWNoKHJlc3BvbnNlID0+IHtcbiAgICAgICAgdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcbiAgICAgICAgdGVzdFV0aWxzLmFzc2VydFJlc3BvbnNlVGltZShyZXNwb25zZSwgMTAwKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBBbGwgcmVzcG9uc2VzIHNob3VsZCBiZSBpZGVudGljYWxcbiAgICAgIGNvbnN0IGZpcnN0UmVzcG9uc2UgPSByZXNwb25zZXNbMF0uYm9keTtcbiAgICAgIHJlc3BvbnNlcy5mb3JFYWNoKHJlc3BvbnNlID0+IHtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkpLnRvRXF1YWwoZmlyc3RSZXNwb25zZSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBtYWludGFpbiBwZXJmb3JtYW5jZSB1bmRlciBtaXhlZCBsb2FkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcblxuICAgICAgLy8gTWl4IG9mIGJhbGFuY2UgYW5kIGN1cnJlbmN5IHJlcXVlc3RzXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgcHJvbWlzZXMucHVzaCh0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvYmFsYW5jZScsIHVzZXJXaXRoQmFsYW5jZSkpO1xuICAgICAgICBwcm9taXNlcy5wdXNoKHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9FVVInLCB1c2VyV2l0aEJhbGFuY2UpKTtcbiAgICAgICAgcHJvbWlzZXMucHVzaCh0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvQU9BJywgdXNlcldpdGhCYWxhbmNlKSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcblxuICAgICAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xuICAgICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgICAgICB0ZXN0VXRpbHMuYXNzZXJ0UmVzcG9uc2VUaW1lKHJlc3BvbnNlLCAxNTApOyAvLyBBbGxvdyBtb3JlIHRpbWUgZm9yIG1peGVkIGxvYWRcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9