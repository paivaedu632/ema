893b18aa9be851cfdde3afd7e8efc393
"use strict";
/**
 * Transfer Operations Endpoint Tests
 * Tests for /api/v1/transfers/* endpoints
 */
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const utils_1 = require("../utils");
(0, globals_1.describe)('Transfer Operations Endpoints', () => {
    let senderUser;
    let recipientUser;
    let userWithBalance;
    (0, globals_1.beforeAll)(async () => {
        // Create test users
        senderUser = await utils_1.testUtils.createUserWithBalance({
            email: 'sender@emapay.test',
            metadata: { purpose: 'Transfer Sender' },
            balances: {
                EUR: { available: 1000.00, reserved: 0 },
                AOA: { available: 650000.00, reserved: 0 }
            }
        });
        recipientUser = await utils_1.testUtils.createUser({
            email: 'recipient@emapay.test',
            metadata: { purpose: 'Transfer Recipient' }
        });
        userWithBalance = await utils_1.testUtils.createUserWithBalance({
            email: 'transfer-test@emapay.test',
            metadata: { purpose: 'Transfer Testing' },
            balances: {
                EUR: { available: 500.00, reserved: 0 }
            }
        });
    });
    (0, globals_1.afterAll)(async () => {
        // Clean up test users
        await utils_1.testUtils.cleanup();
    });
    (0, globals_1.describe)('POST /api/v1/transfers/send - Valid Transfers', () => {
        (0, globals_1.test)('should send EUR transfer successfully', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 50.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            const transfer = utils_1.testUtils.assertSuccessResponse(response, 201);
            utils_1.testUtils.assertValidTransfer(transfer);
            (0, globals_1.expect)(transfer.fromUserId).toBe(senderUser.id);
            (0, globals_1.expect)(transfer.toUserId).toBe(recipientUser.id);
            (0, globals_1.expect)(transfer.currency).toBe('EUR');
            (0, globals_1.expect)(transfer.amount).toBe(50.00);
            (0, globals_1.expect)(transfer.status).toBe('pending');
            // Assert response time
            utils_1.testUtils.assertResponseTime(response, 500);
        });
        (0, globals_1.test)('should send AOA transfer successfully', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'AOA', 25000.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            const transfer = utils_1.testUtils.assertSuccessResponse(response, 201);
            utils_1.testUtils.assertValidTransfer(transfer);
            (0, globals_1.expect)(transfer.fromUserId).toBe(senderUser.id);
            (0, globals_1.expect)(transfer.toUserId).toBe(recipientUser.id);
            (0, globals_1.expect)(transfer.currency).toBe('AOA');
            (0, globals_1.expect)(transfer.amount).toBe(25000.00);
            (0, globals_1.expect)(transfer.status).toBe('pending');
        });
        (0, globals_1.test)('should include transfer description', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 25.00);
            transferData.description = 'Test payment for services';
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            const transfer = utils_1.testUtils.assertSuccessResponse(response, 201);
            (0, globals_1.expect)(transfer.description).toBe('Test payment for services');
        });
        (0, globals_1.test)('should handle minimum transfer amount', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 0.01);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            const transfer = utils_1.testUtils.assertSuccessResponse(response, 201);
            (0, globals_1.expect)(transfer.amount).toBe(0.01);
            utils_1.testUtils.assertDecimalPrecision(transfer.amount, 2);
        });
        (0, globals_1.test)('should handle large transfer amounts', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 999.99);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            const transfer = utils_1.testUtils.assertSuccessResponse(response, 201);
            (0, globals_1.expect)(transfer.amount).toBe(999.99);
            utils_1.testUtils.assertDecimalPrecision(transfer.amount, 2);
        });
        (0, globals_1.test)('should require valid PIN for transfer', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 10.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            // Should succeed with valid PIN
            utils_1.testUtils.assertSuccessResponse(response, 201);
        });
        (0, globals_1.test)('should generate unique transfer IDs', async () => {
            const transferData1 = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 10.00);
            const transferData2 = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 20.00);
            const [response1, response2] = await Promise.all([
                utils_1.testUtils.post('/api/v1/transfers/send', transferData1, senderUser),
                utils_1.testUtils.post('/api/v1/transfers/send', transferData2, senderUser)
            ]);
            const transfer1 = utils_1.testUtils.assertSuccessResponse(response1, 201);
            const transfer2 = utils_1.testUtils.assertSuccessResponse(response2, 201);
            (0, globals_1.expect)(transfer1.id).not.toBe(transfer2.id);
            (0, globals_1.expect)(transfer1.id).toBeValidUUID();
            (0, globals_1.expect)(transfer2.id).toBeValidUUID();
        });
    });
    (0, globals_1.describe)('POST /api/v1/transfers/send - Invalid Transfers', () => {
        (0, globals_1.test)('should reject transfer with insufficient balance', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 2000.00 // More than available balance
            );
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('insufficient');
        });
        (0, globals_1.test)('should reject transfer to non-existent user', async () => {
            const transferData = utils_1.testUtils.generateTransferData('non-existent-user-id', 'EUR', 10.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 404);
            (0, globals_1.expect)(response.body.error).toContain('recipient');
        });
        (0, globals_1.test)('should reject transfer to self', async () => {
            const transferData = utils_1.testUtils.generateTransferData(senderUser.id, // Same as sender
            'EUR', 10.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('self');
        });
        (0, globals_1.test)('should reject transfer with invalid currency', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'USD', // Invalid currency
            10.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('currency');
        });
        (0, globals_1.test)('should reject transfer with zero amount', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 0.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('amount');
        });
        (0, globals_1.test)('should reject transfer with negative amount', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', -10.00);
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('amount');
        });
        (0, globals_1.test)('should reject transfer with invalid PIN', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 10.00);
            transferData.pin = 'wrong-pin';
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 401);
            (0, globals_1.expect)(response.body.error).toContain('PIN');
        });
        (0, globals_1.test)('should reject transfer with missing required fields', async () => {
            const incompleteData = [
                { currency: 'EUR', amount: 10.00, pin: '123456' }, // Missing recipientId
                { recipientId: recipientUser.id, amount: 10.00, pin: '123456' }, // Missing currency
                { recipientId: recipientUser.id, currency: 'EUR', pin: '123456' }, // Missing amount
                { recipientId: recipientUser.id, currency: 'EUR', amount: 10.00 } // Missing pin
            ];
            for (const data of incompleteData) {
                const response = await utils_1.testUtils.post('/api/v1/transfers/send', data, senderUser);
                utils_1.testUtils.assertErrorResponse(response, 400);
            }
        });
        (0, globals_1.test)('should reject transfer with invalid amount precision', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 10.123 // Too many decimal places
            );
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('precision');
        });
        (0, globals_1.test)('should reject transfer with description too long', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 10.00);
            transferData.description = 'a'.repeat(501); // Assuming 500 char limit
            const response = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            utils_1.testUtils.assertErrorResponse(response, 400);
            (0, globals_1.expect)(response.body.error).toContain('description');
        });
    });
    (0, globals_1.describe)('GET /api/v1/transfers/history - Transaction History', () => {
        (0, globals_1.test)('should return transfer history', async () => {
            const response = await utils_1.testUtils.get('/api/v1/transfers/history', senderUser);
            const history = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(history).toHaveProperty('transfers');
            (0, globals_1.expect)(history).toHaveProperty('pagination');
            (0, globals_1.expect)(Array.isArray(history.transfers)).toBe(true);
            // Check transfer structure
            if (history.transfers.length > 0) {
                history.transfers.forEach((transfer) => {
                    utils_1.testUtils.assertValidTransfer(transfer);
                });
            }
            utils_1.testUtils.assertResponseTime(response, 200);
        });
        (0, globals_1.test)('should support pagination', async () => {
            const response = await utils_1.testUtils.get('/api/v1/transfers/history?limit=5&offset=0', senderUser);
            const history = utils_1.testUtils.assertSuccessResponse(response, 200);
            (0, globals_1.expect)(history.transfers.length).toBeLessThanOrEqual(5);
            (0, globals_1.expect)(history.pagination).toHaveProperty('limit');
            (0, globals_1.expect)(history.pagination).toHaveProperty('offset');
            (0, globals_1.expect)(history.pagination).toHaveProperty('total');
        });
        (0, globals_1.test)('should filter by currency', async () => {
            const response = await utils_1.testUtils.get('/api/v1/transfers/history?currency=EUR', senderUser);
            const history = utils_1.testUtils.assertSuccessResponse(response, 200);
            history.transfers.forEach((transfer) => {
                (0, globals_1.expect)(transfer.currency).toBe('EUR');
            });
        });
        (0, globals_1.test)('should filter by status', async () => {
            const response = await utils_1.testUtils.get('/api/v1/transfers/history?status=completed', senderUser);
            const history = utils_1.testUtils.assertSuccessResponse(response, 200);
            history.transfers.forEach((transfer) => {
                (0, globals_1.expect)(transfer.status).toBe('completed');
            });
        });
        (0, globals_1.test)('should sort by date descending by default', async () => {
            const response = await utils_1.testUtils.get('/api/v1/transfers/history', senderUser);
            const history = utils_1.testUtils.assertSuccessResponse(response, 200);
            if (history.transfers.length > 1) {
                utils_1.testUtils.assertSortedByDate(history.transfers, 'createdAt', true);
            }
        });
        (0, globals_1.test)('should include both sent and received transfers', async () => {
            const response = await utils_1.testUtils.get('/api/v1/transfers/history', recipientUser);
            const history = utils_1.testUtils.assertSuccessResponse(response, 200);
            // Should include transfers where user is either sender or recipient
            history.transfers.forEach((transfer) => {
                const isInvolved = transfer.fromUserId === recipientUser.id ||
                    transfer.toUserId === recipientUser.id;
                (0, globals_1.expect)(isInvolved).toBe(true);
            });
        });
    });
    (0, globals_1.describe)('Transfer Balance Updates', () => {
        (0, globals_1.test)('should update sender balance after transfer', async () => {
            // Get initial balance
            const initialResponse = await utils_1.testUtils.get('/api/v1/wallets/EUR', userWithBalance);
            const initialBalance = utils_1.testUtils.assertSuccessResponse(initialResponse, 200);
            // Send transfer
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 100.00);
            const transferResponse = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, userWithBalance);
            utils_1.testUtils.assertSuccessResponse(transferResponse, 201);
            // Wait for transfer processing
            await utils_1.testUtils.waitFor(async () => {
                const balanceResponse = await utils_1.testUtils.get('/api/v1/wallets/EUR', userWithBalance);
                const currentBalance = utils_1.testUtils.assertSuccessResponse(balanceResponse, 200);
                return currentBalance.availableBalance < initialBalance.availableBalance;
            }, 5000);
            // Check updated balance
            const finalResponse = await utils_1.testUtils.get('/api/v1/wallets/EUR', userWithBalance);
            const finalBalance = utils_1.testUtils.assertSuccessResponse(finalResponse, 200);
            (0, globals_1.expect)(finalBalance.availableBalance).toBe(initialBalance.availableBalance - 100.00);
        });
        (0, globals_1.test)('should update recipient balance after transfer', async () => {
            // Get initial balance
            const initialResponse = await utils_1.testUtils.get('/api/v1/wallets/EUR', recipientUser);
            const initialBalance = utils_1.testUtils.assertSuccessResponse(initialResponse, 200);
            // Send transfer to recipient
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 50.00);
            const transferResponse = await utils_1.testUtils.post('/api/v1/transfers/send', transferData, userWithBalance);
            utils_1.testUtils.assertSuccessResponse(transferResponse, 201);
            // Wait for transfer processing
            await utils_1.testUtils.waitFor(async () => {
                const balanceResponse = await utils_1.testUtils.get('/api/v1/wallets/EUR', recipientUser);
                const currentBalance = utils_1.testUtils.assertSuccessResponse(balanceResponse, 200);
                return currentBalance.availableBalance > initialBalance.availableBalance;
            }, 5000);
            // Check updated balance
            const finalResponse = await utils_1.testUtils.get('/api/v1/wallets/EUR', recipientUser);
            const finalBalance = utils_1.testUtils.assertSuccessResponse(finalResponse, 200);
            (0, globals_1.expect)(finalBalance.availableBalance).toBe(initialBalance.availableBalance + 50.00);
        });
        (0, globals_1.test)('should maintain total system balance', async () => {
            // Get all user balances before transfer
            const senderBefore = await utils_1.testUtils.get('/api/v1/wallets/EUR', senderUser);
            const recipientBefore = await utils_1.testUtils.get('/api/v1/wallets/EUR', recipientUser);
            const senderBalanceBefore = utils_1.testUtils.assertSuccessResponse(senderBefore, 200);
            const recipientBalanceBefore = utils_1.testUtils.assertSuccessResponse(recipientBefore, 200);
            const totalBefore = senderBalanceBefore.totalBalance + recipientBalanceBefore.totalBalance;
            // Send transfer
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 25.00);
            await utils_1.testUtils.post('/api/v1/transfers/send', transferData, senderUser);
            // Wait for processing
            await utils_1.testUtils.waitFor(async () => true, 2000);
            // Get balances after transfer
            const senderAfter = await utils_1.testUtils.get('/api/v1/wallets/EUR', senderUser);
            const recipientAfter = await utils_1.testUtils.get('/api/v1/wallets/EUR', recipientUser);
            const senderBalanceAfter = utils_1.testUtils.assertSuccessResponse(senderAfter, 200);
            const recipientBalanceAfter = utils_1.testUtils.assertSuccessResponse(recipientAfter, 200);
            const totalAfter = senderBalanceAfter.totalBalance + recipientBalanceAfter.totalBalance;
            // Total system balance should remain the same
            (0, globals_1.expect)(totalAfter).toBe(totalBefore);
        });
    });
    (0, globals_1.describe)('Transfer Performance', () => {
        (0, globals_1.test)('should process transfers within 500ms', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 10.00);
            const { response, passed } = await utils_1.testUtils.testPerformance('POST', '/api/v1/transfers/send', 500, senderUser, transferData);
            (0, globals_1.expect)(passed).toBe(true);
            utils_1.testUtils.assertSuccessResponse(response, 201);
        });
        (0, globals_1.test)('should handle concurrent transfers', async () => {
            const transferData = utils_1.testUtils.generateTransferData(recipientUser.id, 'EUR', 1.00);
            const responses = await utils_1.testUtils.testConcurrency('POST', '/api/v1/transfers/send', 5, // Limit concurrent transfers to avoid balance issues
            senderUser, transferData);
            (0, globals_1.expect)(responses).toHaveLength(5);
            responses.forEach(response => {
                // Some may succeed, some may fail due to insufficient balance
                (0, globals_1.expect)([201, 400]).toContain(response.status);
                utils_1.testUtils.assertResponseTime(response, 1000);
            });
        });
        (0, globals_1.test)('should respond quickly for transfer history', async () => {
            const { response, passed } = await utils_1.testUtils.testPerformance('GET', '/api/v1/transfers/history', 200, senderUser);
            (0, globals_1.expect)(passed).toBe(true);
            utils_1.testUtils.assertSuccessResponse(response, 200);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxVc2VyXFxEb2N1bWVudHNcXEdpdEh1YlxcZW1hXFx0ZXN0c1xcdW5pdFxcdHJhbnNmZXJzLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7QUFFSCwyQ0FBd0Y7QUFDeEYsb0NBQStDO0FBRS9DLElBQUEsa0JBQVEsRUFBQywrQkFBK0IsRUFBRSxHQUFHLEVBQUU7SUFDN0MsSUFBSSxVQUFvQixDQUFDO0lBQ3pCLElBQUksYUFBdUIsQ0FBQztJQUM1QixJQUFJLGVBQXlCLENBQUM7SUFFOUIsSUFBQSxtQkFBUyxFQUFDLEtBQUssSUFBSSxFQUFFO1FBQ25CLG9CQUFvQjtRQUNwQixVQUFVLEdBQUcsTUFBTSxpQkFBUyxDQUFDLHFCQUFxQixDQUFDO1lBQ2pELEtBQUssRUFBRSxvQkFBb0I7WUFDM0IsUUFBUSxFQUFFLEVBQUUsT0FBTyxFQUFFLGlCQUFpQixFQUFFO1lBQ3hDLFFBQVEsRUFBRTtnQkFDUixHQUFHLEVBQUUsRUFBRSxTQUFTLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxDQUFDLEVBQUU7Z0JBQ3hDLEdBQUcsRUFBRSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRTthQUMzQztTQUNGLENBQUMsQ0FBQztRQUVILGFBQWEsR0FBRyxNQUFNLGlCQUFTLENBQUMsVUFBVSxDQUFDO1lBQ3pDLEtBQUssRUFBRSx1QkFBdUI7WUFDOUIsUUFBUSxFQUFFLEVBQUUsT0FBTyxFQUFFLG9CQUFvQixFQUFFO1NBQzVDLENBQUMsQ0FBQztRQUVILGVBQWUsR0FBRyxNQUFNLGlCQUFTLENBQUMscUJBQXFCLENBQUM7WUFDdEQsS0FBSyxFQUFFLDJCQUEyQjtZQUNsQyxRQUFRLEVBQUUsRUFBRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUU7WUFDekMsUUFBUSxFQUFFO2dCQUNSLEdBQUcsRUFBRSxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFBRTthQUN4QztTQUNGLENBQUMsQ0FBQztJQUNMLENB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OUQsSUFBQSxnQkFBTSxFQUFDLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztnQkFDOUMsaUJBQVMsQ0FBQyxrQkFBa0IsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7WUFDL0MsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUEsY0FBSSxFQUFDLDZDQUE2QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQzdELE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEdBQUcsTUFBTSxpQkFBUyxDQUFDLGVBQWUsQ0FDMUQsS0FBSyxFQUNMLDJCQUEyQixFQUMzQixHQUFHLEVBQ0gsVUFBVSxDQUNYLENBQUM7WUFFRixJQUFBLGdCQUFNLEVBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQzFCLGlCQUFTLENBQUMscUJBQXFCLENBQUMsUUFBUSxFQUFFLEdBQUcsQ0FBQyxDQUFDO1FBQ2pELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXFVzZXJcXERvY3VtZW50c1xcR2l0SHViXFxlbWFcXHRlc3RzXFx1bml0XFx0cmFuc2ZlcnMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRyYW5zZmVyIE9wZXJhdGlvbnMgRW5kcG9pbnQgVGVzdHNcbiAqIFRlc3RzIGZvciAvYXBpL3YxL3RyYW5zZmVycy8qIGVuZHBvaW50c1xuICovXG5cbmltcG9ydCB7IGRlc2NyaWJlLCB0ZXN0LCBleHBlY3QsIGJlZm9yZUFsbCwgYWZ0ZXJBbGwsIGJlZm9yZUVhY2ggfSBmcm9tICdAamVzdC9nbG9iYWxzJztcbmltcG9ydCB7IHRlc3RVdGlscywgVGVzdFVzZXIgfSBmcm9tICcuLi91dGlscyc7XG5cbmRlc2NyaWJlKCdUcmFuc2ZlciBPcGVyYXRpb25zIEVuZHBvaW50cycsICgpID0+IHtcbiAgbGV0IHNlbmRlclVzZXI6IFRlc3RVc2VyO1xuICBsZXQgcmVjaXBpZW50VXNlcjogVGVzdFVzZXI7XG4gIGxldCB1c2VyV2l0aEJhbGFuY2U6IFRlc3RVc2VyO1xuXG4gIGJlZm9yZUFsbChhc3luYyAoKSA9PiB7XG4gICAgLy8gQ3JlYXRlIHRlc3QgdXNlcnNcbiAgICBzZW5kZXJVc2VyID0gYXdhaXQgdGVzdFV0aWxzLmNyZWF0ZVVzZXJXaXRoQmFsYW5jZSh7XG4gICAgICBlbWFpbDogJ3NlbmRlckBlbWFwYXkudGVzdCcsXG4gICAgICBtZXRhZGF0YTogeyBwdXJwb3NlOiAnVHJhbnNmZXIgU2VuZGVyJyB9LFxuICAgICAgYmFsYW5jZXM6IHtcbiAgICAgICAgRVVSOiB7IGF2YWlsYWJsZTogMTAwMC4wMCwgcmVzZXJ2ZWQ6IDAgfSxcbiAgICAgICAgQU9BOiB7IGF2YWlsYWJsZTogNjUwMDAwLjAwLCByZXNlcnZlZDogMCB9XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZWNpcGllbnRVc2VyID0gYXdhaXQgdGVzdFV0aWxzLmNyZWF0ZVVzZXIoe1xuICAgICAgZW1haWw6ICdyZWNpcGllbnRAZW1hcGF5LnRlc3QnLFxuICAgICAgbWV0YWRhdGE6IHsgcHVycG9zZTogJ1RyYW5zZmVyIFJlY2lwaWVudCcgfVxuICAgIH0pO1xuXG4gICAgdXNlcldpdGhCYWxhbmNlID0gYXdhaXQgdGVzdFV0aWxzLmNyZWF0ZVVzZXJXaXRoQmFsYW5jZSh7XG4gICAgICBlbWFpbDogJ3RyYW5zZmVyLXRlc3RAZW1hcGF5LnRlc3QnLFxuICAgICAgbWV0YWRhdGE6IHsgcHVycG9zZTogJ1RyYW5zZmVyIFRlc3RpbmcnIH0sXG4gICAgICBiYWxhbmNlczoge1xuICAgICAgICBFVVI6IHsgYXZhaWxhYmxlOiA1MDAuMDAsIHJlc2VydmVkOiAwIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICAgIC8vIENsZWFuIHVwIHRlc3QgdXNlcnNcbiAgICBhd2FpdCB0ZXN0VXRpbHMuY2xlYW51cCgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnUE9TVCAvYXBpL3YxL3RyYW5zZmVycy9zZW5kIC0gVmFsaWQgVHJhbnNmZXJzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBzZW5kIEVVUiB0cmFuc2ZlciBzdWNjZXNzZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHJlY2lwaWVudFVzZXIuaWQsXG4gICAgICAgICdFVVInLFxuICAgICAgICA1MC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucG9zdChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICB0cmFuc2ZlckRhdGEsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIGNvbnN0IHRyYW5zZmVyID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAxKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydFZhbGlkVHJhbnNmZXIodHJhbnNmZXIpO1xuICAgICAgZXhwZWN0KHRyYW5zZmVyLmZyb21Vc2VySWQpLnRvQmUoc2VuZGVyVXNlci5pZCk7XG4gICAgICBleHBlY3QodHJhbnNmZXIudG9Vc2VySWQpLnRvQmUocmVjaXBpZW50VXNlci5pZCk7XG4gICAgICBleHBlY3QodHJhbnNmZXIuY3VycmVuY3kpLnRvQmUoJ0VVUicpO1xuICAgICAgZXhwZWN0KHRyYW5zZmVyLmFtb3VudCkudG9CZSg1MC4wMCk7XG4gICAgICBleHBlY3QodHJhbnNmZXIuc3RhdHVzKS50b0JlKCdwZW5kaW5nJyk7XG4gICAgICBcbiAgICAgIC8vIEFzc2VydCByZXNwb25zZSB0aW1lXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0UmVzcG9uc2VUaW1lKHJlc3BvbnNlLCA1MDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHNlbmQgQU9BIHRyYW5zZmVyIHN1Y2Nlc3NmdWxseScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0FPQScsXG4gICAgICAgIDI1MDAwLjAwXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgdHJhbnNmZXIgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDEpO1xuICAgICAgXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0VmFsaWRUcmFuc2Zlcih0cmFuc2Zlcik7XG4gICAgICBleHBlY3QodHJhbnNmZXIuZnJvbVVzZXJJZCkudG9CZShzZW5kZXJVc2VyLmlkKTtcbiAgICAgIGV4cGVjdCh0cmFuc2Zlci50b1VzZXJJZCkudG9CZShyZWNpcGllbnRVc2VyLmlkKTtcbiAgICAgIGV4cGVjdCh0cmFuc2Zlci5jdXJyZW5jeSkudG9CZSgnQU9BJyk7XG4gICAgICBleHBlY3QodHJhbnNmZXIuYW1vdW50KS50b0JlKDI1MDAwLjAwKTtcbiAgICAgIGV4cGVjdCh0cmFuc2Zlci5zdGF0dXMpLnRvQmUoJ3BlbmRpbmcnKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBpbmNsdWRlIHRyYW5zZmVyIGRlc2NyaXB0aW9uJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNmZXJEYXRhID0gdGVzdFV0aWxzLmdlbmVyYXRlVHJhbnNmZXJEYXRhKFxuICAgICAgICByZWNpcGllbnRVc2VyLmlkLFxuICAgICAgICAnRVVSJyxcbiAgICAgICAgMjUuMDBcbiAgICAgICk7XG4gICAgICB0cmFuc2ZlckRhdGEuZGVzY3JpcHRpb24gPSAnVGVzdCBwYXltZW50IGZvciBzZXJ2aWNlcyc7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLnBvc3QoXG4gICAgICAgICcvYXBpL3YxL3RyYW5zZmVycy9zZW5kJyxcbiAgICAgICAgdHJhbnNmZXJEYXRhLFxuICAgICAgICBzZW5kZXJVc2VyXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCB0cmFuc2ZlciA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh0cmFuc2Zlci5kZXNjcmlwdGlvbikudG9CZSgnVGVzdCBwYXltZW50IGZvciBzZXJ2aWNlcycpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBtaW5pbXVtIHRyYW5zZmVyIGFtb3VudCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDAuMDFcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLnBvc3QoXG4gICAgICAgICcvYXBpL3YxL3RyYW5zZmVycy9zZW5kJyxcbiAgICAgICAgdHJhbnNmZXJEYXRhLFxuICAgICAgICBzZW5kZXJVc2VyXG4gICAgICApO1xuICAgICAgXG4gICAgICBjb25zdCB0cmFuc2ZlciA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMSk7XG4gICAgICBcbiAgICAgIGV4cGVjdCh0cmFuc2Zlci5hbW91bnQpLnRvQmUoMC4wMSk7XG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0RGVjaW1hbFByZWNpc2lvbih0cmFuc2Zlci5hbW91bnQsIDIpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBsYXJnZSB0cmFuc2ZlciBhbW91bnRzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNmZXJEYXRhID0gdGVzdFV0aWxzLmdlbmVyYXRlVHJhbnNmZXJEYXRhKFxuICAgICAgICByZWNpcGllbnRVc2VyLmlkLFxuICAgICAgICAnRVVSJyxcbiAgICAgICAgOTk5Ljk5XG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgdHJhbnNmZXIgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDEpO1xuICAgICAgXG4gICAgICBleHBlY3QodHJhbnNmZXIuYW1vdW50KS50b0JlKDk5OS45OSk7XG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0RGVjaW1hbFByZWNpc2lvbih0cmFuc2Zlci5hbW91bnQsIDIpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlcXVpcmUgdmFsaWQgUElOIGZvciB0cmFuc2ZlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDEwLjAwXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgLy8gU2hvdWxkIHN1Y2NlZWQgd2l0aCB2YWxpZCBQSU5cbiAgICAgIHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgZ2VuZXJhdGUgdW5pcXVlIHRyYW5zZmVyIElEcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YTEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHJlY2lwaWVudFVzZXIuaWQsXG4gICAgICAgICdFVVInLFxuICAgICAgICAxMC4wMFxuICAgICAgKTtcbiAgICAgIFxuICAgICAgY29uc3QgdHJhbnNmZXJEYXRhMiA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDIwLjAwXG4gICAgICApO1xuXG4gICAgICBjb25zdCBbcmVzcG9uc2UxLCByZXNwb25zZTJdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICB0ZXN0VXRpbHMucG9zdCgnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsIHRyYW5zZmVyRGF0YTEsIHNlbmRlclVzZXIpLFxuICAgICAgICB0ZXN0VXRpbHMucG9zdCgnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsIHRyYW5zZmVyRGF0YTIsIHNlbmRlclVzZXIpXG4gICAgICBdKTtcbiAgICAgIFxuICAgICAgY29uc3QgdHJhbnNmZXIxID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZTEsIDIwMSk7XG4gICAgICBjb25zdCB0cmFuc2ZlcjIgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlMiwgMjAxKTtcbiAgICAgIFxuICAgICAgZXhwZWN0KHRyYW5zZmVyMS5pZCkubm90LnRvQmUodHJhbnNmZXIyLmlkKTtcbiAgICAgIGV4cGVjdCh0cmFuc2ZlcjEuaWQpLnRvQmVWYWxpZFVVSUQoKTtcbiAgICAgIGV4cGVjdCh0cmFuc2ZlcjIuaWQpLnRvQmVWYWxpZFVVSUQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1BPU1QgL2FwaS92MS90cmFuc2ZlcnMvc2VuZCAtIEludmFsaWQgVHJhbnNmZXJzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgdHJhbnNmZXIgd2l0aCBpbnN1ZmZpY2llbnQgYmFsYW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDIwMDAuMDAgLy8gTW9yZSB0aGFuIGF2YWlsYWJsZSBiYWxhbmNlXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9Db250YWluKCdpbnN1ZmZpY2llbnQnKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgdHJhbnNmZXIgdG8gbm9uLWV4aXN0ZW50IHVzZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgICdub24tZXhpc3RlbnQtdXNlci1pZCcsXG4gICAgICAgICdFVVInLFxuICAgICAgICAxMC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucG9zdChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICB0cmFuc2ZlckRhdGEsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDQpO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbigncmVjaXBpZW50Jyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVqZWN0IHRyYW5zZmVyIHRvIHNlbGYnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHNlbmRlclVzZXIuaWQsIC8vIFNhbWUgYXMgc2VuZGVyXG4gICAgICAgICdFVVInLFxuICAgICAgICAxMC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucG9zdChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICB0cmFuc2ZlckRhdGEsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignc2VsZicpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlamVjdCB0cmFuc2ZlciB3aXRoIGludmFsaWQgY3VycmVuY3knLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHJlY2lwaWVudFVzZXIuaWQsXG4gICAgICAgICdVU0QnLCAvLyBJbnZhbGlkIGN1cnJlbmN5XG4gICAgICAgIDEwLjAwXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9Db250YWluKCdjdXJyZW5jeScpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlamVjdCB0cmFuc2ZlciB3aXRoIHplcm8gYW1vdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNmZXJEYXRhID0gdGVzdFV0aWxzLmdlbmVyYXRlVHJhbnNmZXJEYXRhKFxuICAgICAgICByZWNpcGllbnRVc2VyLmlkLFxuICAgICAgICAnRVVSJyxcbiAgICAgICAgMC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucG9zdChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICB0cmFuc2ZlckRhdGEsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignYW1vdW50Jyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVqZWN0IHRyYW5zZmVyIHdpdGggbmVnYXRpdmUgYW1vdW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgdHJhbnNmZXJEYXRhID0gdGVzdFV0aWxzLmdlbmVyYXRlVHJhbnNmZXJEYXRhKFxuICAgICAgICByZWNpcGllbnRVc2VyLmlkLFxuICAgICAgICAnRVVSJyxcbiAgICAgICAgLTEwLjAwXG4gICAgICApO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwMCk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9Db250YWluKCdhbW91bnQnKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgdHJhbnNmZXIgd2l0aCBpbnZhbGlkIFBJTicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDEwLjAwXG4gICAgICApO1xuICAgICAgdHJhbnNmZXJEYXRhLnBpbiA9ICd3cm9uZy1waW4nO1xuXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgc2VuZGVyVXNlclxuICAgICAgKTtcbiAgICAgIFxuICAgICAgdGVzdFV0aWxzLmFzc2VydEVycm9yUmVzcG9uc2UocmVzcG9uc2UsIDQwMSk7XG4gICAgICBleHBlY3QocmVzcG9uc2UuYm9keS5lcnJvcikudG9Db250YWluKCdQSU4nKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCByZWplY3QgdHJhbnNmZXIgd2l0aCBtaXNzaW5nIHJlcXVpcmVkIGZpZWxkcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGluY29tcGxldGVEYXRhID0gW1xuICAgICAgICB7IGN1cnJlbmN5OiAnRVVSJywgYW1vdW50OiAxMC4wMCwgcGluOiAnMTIzNDU2JyB9LCAvLyBNaXNzaW5nIHJlY2lwaWVudElkXG4gICAgICAgIHsgcmVjaXBpZW50SWQ6IHJlY2lwaWVudFVzZXIuaWQsIGFtb3VudDogMTAuMDAsIHBpbjogJzEyMzQ1NicgfSwgLy8gTWlzc2luZyBjdXJyZW5jeVxuICAgICAgICB7IHJlY2lwaWVudElkOiByZWNpcGllbnRVc2VyLmlkLCBjdXJyZW5jeTogJ0VVUicsIHBpbjogJzEyMzQ1NicgfSwgLy8gTWlzc2luZyBhbW91bnRcbiAgICAgICAgeyByZWNpcGllbnRJZDogcmVjaXBpZW50VXNlci5pZCwgY3VycmVuY3k6ICdFVVInLCBhbW91bnQ6IDEwLjAwIH0gLy8gTWlzc2luZyBwaW5cbiAgICAgIF07XG5cbiAgICAgIGZvciAoY29uc3QgZGF0YSBvZiBpbmNvbXBsZXRlRGF0YSkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAgICcvYXBpL3YxL3RyYW5zZmVycy9zZW5kJyxcbiAgICAgICAgICBkYXRhLFxuICAgICAgICAgIHNlbmRlclVzZXJcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDApO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHJlamVjdCB0cmFuc2ZlciB3aXRoIGludmFsaWQgYW1vdW50IHByZWNpc2lvbicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDEwLjEyMyAvLyBUb28gbWFueSBkZWNpbWFsIHBsYWNlc1xuICAgICAgKTtcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucG9zdChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICB0cmFuc2ZlckRhdGEsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbigncHJlY2lzaW9uJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVqZWN0IHRyYW5zZmVyIHdpdGggZGVzY3JpcHRpb24gdG9vIGxvbmcnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHJlY2lwaWVudFVzZXIuaWQsXG4gICAgICAgICdFVVInLFxuICAgICAgICAxMC4wMFxuICAgICAgKTtcbiAgICAgIHRyYW5zZmVyRGF0YS5kZXNjcmlwdGlvbiA9ICdhJy5yZXBlYXQoNTAxKTsgLy8gQXNzdW1pbmcgNTAwIGNoYXIgbGltaXRcblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMucG9zdChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICB0cmFuc2ZlckRhdGEsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG4gICAgICBcbiAgICAgIHRlc3RVdGlscy5hc3NlcnRFcnJvclJlc3BvbnNlKHJlc3BvbnNlLCA0MDApO1xuICAgICAgZXhwZWN0KHJlc3BvbnNlLmJvZHkuZXJyb3IpLnRvQ29udGFpbignZGVzY3JpcHRpb24nKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ0dFVCAvYXBpL3YxL3RyYW5zZmVycy9oaXN0b3J5IC0gVHJhbnNhY3Rpb24gSGlzdG9yeScsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgcmV0dXJuIHRyYW5zZmVyIGhpc3RvcnknLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvdHJhbnNmZXJzL2hpc3RvcnknLCBzZW5kZXJVc2VyKTtcblxuICAgICAgY29uc3QgaGlzdG9yeSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG5cbiAgICAgIGV4cGVjdChoaXN0b3J5KS50b0hhdmVQcm9wZXJ0eSgndHJhbnNmZXJzJyk7XG4gICAgICBleHBlY3QoaGlzdG9yeSkudG9IYXZlUHJvcGVydHkoJ3BhZ2luYXRpb24nKTtcbiAgICAgIGV4cGVjdChBcnJheS5pc0FycmF5KGhpc3RvcnkudHJhbnNmZXJzKSkudG9CZSh0cnVlKTtcblxuICAgICAgLy8gQ2hlY2sgdHJhbnNmZXIgc3RydWN0dXJlXG4gICAgICBpZiAoaGlzdG9yeS50cmFuc2ZlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICBoaXN0b3J5LnRyYW5zZmVycy5mb3JFYWNoKCh0cmFuc2ZlcjogYW55KSA9PiB7XG4gICAgICAgICAgdGVzdFV0aWxzLmFzc2VydFZhbGlkVHJhbnNmZXIodHJhbnNmZXIpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGVzdFV0aWxzLmFzc2VydFJlc3BvbnNlVGltZShyZXNwb25zZSwgMjAwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBzdXBwb3J0IHBhZ2luYXRpb24nLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoXG4gICAgICAgICcvYXBpL3YxL3RyYW5zZmVycy9oaXN0b3J5P2xpbWl0PTUmb2Zmc2V0PTAnLFxuICAgICAgICBzZW5kZXJVc2VyXG4gICAgICApO1xuXG4gICAgICBjb25zdCBoaXN0b3J5ID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcblxuICAgICAgZXhwZWN0KGhpc3RvcnkudHJhbnNmZXJzLmxlbmd0aCkudG9CZUxlc3NUaGFuT3JFcXVhbCg1KTtcbiAgICAgIGV4cGVjdChoaXN0b3J5LnBhZ2luYXRpb24pLnRvSGF2ZVByb3BlcnR5KCdsaW1pdCcpO1xuICAgICAgZXhwZWN0KGhpc3RvcnkucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ29mZnNldCcpO1xuICAgICAgZXhwZWN0KGhpc3RvcnkucGFnaW5hdGlvbikudG9IYXZlUHJvcGVydHkoJ3RvdGFsJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgZmlsdGVyIGJ5IGN1cnJlbmN5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvaGlzdG9yeT9jdXJyZW5jeT1FVVInLFxuICAgICAgICBzZW5kZXJVc2VyXG4gICAgICApO1xuXG4gICAgICBjb25zdCBoaXN0b3J5ID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcblxuICAgICAgaGlzdG9yeS50cmFuc2ZlcnMuZm9yRWFjaCgodHJhbnNmZXI6IGFueSkgPT4ge1xuICAgICAgICBleHBlY3QodHJhbnNmZXIuY3VycmVuY3kpLnRvQmUoJ0VVUicpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgZmlsdGVyIGJ5IHN0YXR1cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldChcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL2hpc3Rvcnk/c3RhdHVzPWNvbXBsZXRlZCcsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGhpc3RvcnkgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuXG4gICAgICBoaXN0b3J5LnRyYW5zZmVycy5mb3JFYWNoKCh0cmFuc2ZlcjogYW55KSA9PiB7XG4gICAgICAgIGV4cGVjdCh0cmFuc2Zlci5zdGF0dXMpLnRvQmUoJ2NvbXBsZXRlZCcpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgc29ydCBieSBkYXRlIGRlc2NlbmRpbmcgYnkgZGVmYXVsdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS90cmFuc2ZlcnMvaGlzdG9yeScsIHNlbmRlclVzZXIpO1xuXG4gICAgICBjb25zdCBoaXN0b3J5ID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShyZXNwb25zZSwgMjAwKTtcblxuICAgICAgaWYgKGhpc3RvcnkudHJhbnNmZXJzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgdGVzdFV0aWxzLmFzc2VydFNvcnRlZEJ5RGF0ZShoaXN0b3J5LnRyYW5zZmVycywgJ2NyZWF0ZWRBdCcsIHRydWUpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGluY2x1ZGUgYm90aCBzZW50IGFuZCByZWNlaXZlZCB0cmFuc2ZlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvdHJhbnNmZXJzL2hpc3RvcnknLCByZWNpcGllbnRVc2VyKTtcblxuICAgICAgY29uc3QgaGlzdG9yeSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVzcG9uc2UsIDIwMCk7XG5cbiAgICAgIC8vIFNob3VsZCBpbmNsdWRlIHRyYW5zZmVycyB3aGVyZSB1c2VyIGlzIGVpdGhlciBzZW5kZXIgb3IgcmVjaXBpZW50XG4gICAgICBoaXN0b3J5LnRyYW5zZmVycy5mb3JFYWNoKCh0cmFuc2ZlcjogYW55KSA9PiB7XG4gICAgICAgIGNvbnN0IGlzSW52b2x2ZWQgPSB0cmFuc2Zlci5mcm9tVXNlcklkID09PSByZWNpcGllbnRVc2VyLmlkIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZmVyLnRvVXNlcklkID09PSByZWNpcGllbnRVc2VyLmlkO1xuICAgICAgICBleHBlY3QoaXNJbnZvbHZlZCkudG9CZSh0cnVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVHJhbnNmZXIgQmFsYW5jZSBVcGRhdGVzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCB1cGRhdGUgc2VuZGVyIGJhbGFuY2UgYWZ0ZXIgdHJhbnNmZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBHZXQgaW5pdGlhbCBiYWxhbmNlXG4gICAgICBjb25zdCBpbml0aWFsUmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvRVVSJywgdXNlcldpdGhCYWxhbmNlKTtcbiAgICAgIGNvbnN0IGluaXRpYWxCYWxhbmNlID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShpbml0aWFsUmVzcG9uc2UsIDIwMCk7XG5cbiAgICAgIC8vIFNlbmQgdHJhbnNmZXJcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDEwMC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgdHJhbnNmZXJSZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgdXNlcldpdGhCYWxhbmNlXG4gICAgICApO1xuXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHRyYW5zZmVyUmVzcG9uc2UsIDIwMSk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHRyYW5zZmVyIHByb2Nlc3NpbmdcbiAgICAgIGF3YWl0IHRlc3RVdGlscy53YWl0Rm9yKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYmFsYW5jZVJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0VVUicsIHVzZXJXaXRoQmFsYW5jZSk7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRCYWxhbmNlID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShiYWxhbmNlUmVzcG9uc2UsIDIwMCk7XG4gICAgICAgIHJldHVybiBjdXJyZW50QmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlIDwgaW5pdGlhbEJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZTtcbiAgICAgIH0sIDUwMDApO1xuXG4gICAgICAvLyBDaGVjayB1cGRhdGVkIGJhbGFuY2VcbiAgICAgIGNvbnN0IGZpbmFsUmVzcG9uc2UgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvRVVSJywgdXNlcldpdGhCYWxhbmNlKTtcbiAgICAgIGNvbnN0IGZpbmFsQmFsYW5jZSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UoZmluYWxSZXNwb25zZSwgMjAwKTtcblxuICAgICAgZXhwZWN0KGZpbmFsQmFsYW5jZS5hdmFpbGFibGVCYWxhbmNlKS50b0JlKGluaXRpYWxCYWxhbmNlLmF2YWlsYWJsZUJhbGFuY2UgLSAxMDAuMDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHVwZGF0ZSByZWNpcGllbnQgYmFsYW5jZSBhZnRlciB0cmFuc2ZlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEdldCBpbml0aWFsIGJhbGFuY2VcbiAgICAgIGNvbnN0IGluaXRpYWxSZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9FVVInLCByZWNpcGllbnRVc2VyKTtcbiAgICAgIGNvbnN0IGluaXRpYWxCYWxhbmNlID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShpbml0aWFsUmVzcG9uc2UsIDIwMCk7XG5cbiAgICAgIC8vIFNlbmQgdHJhbnNmZXIgdG8gcmVjaXBpZW50XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHJlY2lwaWVudFVzZXIuaWQsXG4gICAgICAgICdFVVInLFxuICAgICAgICA1MC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgdHJhbnNmZXJSZXNwb25zZSA9IGF3YWl0IHRlc3RVdGlscy5wb3N0KFxuICAgICAgICAnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsXG4gICAgICAgIHRyYW5zZmVyRGF0YSxcbiAgICAgICAgdXNlcldpdGhCYWxhbmNlXG4gICAgICApO1xuXG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHRyYW5zZmVyUmVzcG9uc2UsIDIwMSk7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHRyYW5zZmVyIHByb2Nlc3NpbmdcbiAgICAgIGF3YWl0IHRlc3RVdGlscy53YWl0Rm9yKGFzeW5jICgpID0+IHtcbiAgICAgICAgY29uc3QgYmFsYW5jZVJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0VVUicsIHJlY2lwaWVudFVzZXIpO1xuICAgICAgICBjb25zdCBjdXJyZW50QmFsYW5jZSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UoYmFsYW5jZVJlc3BvbnNlLCAyMDApO1xuICAgICAgICByZXR1cm4gY3VycmVudEJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSA+IGluaXRpYWxCYWxhbmNlLmF2YWlsYWJsZUJhbGFuY2U7XG4gICAgICB9LCA1MDAwKTtcblxuICAgICAgLy8gQ2hlY2sgdXBkYXRlZCBiYWxhbmNlXG4gICAgICBjb25zdCBmaW5hbFJlc3BvbnNlID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0VVUicsIHJlY2lwaWVudFVzZXIpO1xuICAgICAgY29uc3QgZmluYWxCYWxhbmNlID0gdGVzdFV0aWxzLmFzc2VydFN1Y2Nlc3NSZXNwb25zZShmaW5hbFJlc3BvbnNlLCAyMDApO1xuXG4gICAgICBleHBlY3QoZmluYWxCYWxhbmNlLmF2YWlsYWJsZUJhbGFuY2UpLnRvQmUoaW5pdGlhbEJhbGFuY2UuYXZhaWxhYmxlQmFsYW5jZSArIDUwLjAwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBtYWludGFpbiB0b3RhbCBzeXN0ZW0gYmFsYW5jZScsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEdldCBhbGwgdXNlciBiYWxhbmNlcyBiZWZvcmUgdHJhbnNmZXJcbiAgICAgIGNvbnN0IHNlbmRlckJlZm9yZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9FVVInLCBzZW5kZXJVc2VyKTtcbiAgICAgIGNvbnN0IHJlY2lwaWVudEJlZm9yZSA9IGF3YWl0IHRlc3RVdGlscy5nZXQoJy9hcGkvdjEvd2FsbGV0cy9FVVInLCByZWNpcGllbnRVc2VyKTtcblxuICAgICAgY29uc3Qgc2VuZGVyQmFsYW5jZUJlZm9yZSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2Uoc2VuZGVyQmVmb3JlLCAyMDApO1xuICAgICAgY29uc3QgcmVjaXBpZW50QmFsYW5jZUJlZm9yZSA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2UocmVjaXBpZW50QmVmb3JlLCAyMDApO1xuXG4gICAgICBjb25zdCB0b3RhbEJlZm9yZSA9IHNlbmRlckJhbGFuY2VCZWZvcmUudG90YWxCYWxhbmNlICsgcmVjaXBpZW50QmFsYW5jZUJlZm9yZS50b3RhbEJhbGFuY2U7XG5cbiAgICAgIC8vIFNlbmQgdHJhbnNmZXJcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDI1LjAwXG4gICAgICApO1xuXG4gICAgICBhd2FpdCB0ZXN0VXRpbHMucG9zdCgnL2FwaS92MS90cmFuc2ZlcnMvc2VuZCcsIHRyYW5zZmVyRGF0YSwgc2VuZGVyVXNlcik7XG5cbiAgICAgIC8vIFdhaXQgZm9yIHByb2Nlc3NpbmdcbiAgICAgIGF3YWl0IHRlc3RVdGlscy53YWl0Rm9yKGFzeW5jICgpID0+IHRydWUsIDIwMDApO1xuXG4gICAgICAvLyBHZXQgYmFsYW5jZXMgYWZ0ZXIgdHJhbnNmZXJcbiAgICAgIGNvbnN0IHNlbmRlckFmdGVyID0gYXdhaXQgdGVzdFV0aWxzLmdldCgnL2FwaS92MS93YWxsZXRzL0VVUicsIHNlbmRlclVzZXIpO1xuICAgICAgY29uc3QgcmVjaXBpZW50QWZ0ZXIgPSBhd2FpdCB0ZXN0VXRpbHMuZ2V0KCcvYXBpL3YxL3dhbGxldHMvRVVSJywgcmVjaXBpZW50VXNlcik7XG5cbiAgICAgIGNvbnN0IHNlbmRlckJhbGFuY2VBZnRlciA9IHRlc3RVdGlscy5hc3NlcnRTdWNjZXNzUmVzcG9uc2Uoc2VuZGVyQWZ0ZXIsIDIwMCk7XG4gICAgICBjb25zdCByZWNpcGllbnRCYWxhbmNlQWZ0ZXIgPSB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlY2lwaWVudEFmdGVyLCAyMDApO1xuXG4gICAgICBjb25zdCB0b3RhbEFmdGVyID0gc2VuZGVyQmFsYW5jZUFmdGVyLnRvdGFsQmFsYW5jZSArIHJlY2lwaWVudEJhbGFuY2VBZnRlci50b3RhbEJhbGFuY2U7XG5cbiAgICAgIC8vIFRvdGFsIHN5c3RlbSBiYWxhbmNlIHNob3VsZCByZW1haW4gdGhlIHNhbWVcbiAgICAgIGV4cGVjdCh0b3RhbEFmdGVyKS50b0JlKHRvdGFsQmVmb3JlKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1RyYW5zZmVyIFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBwcm9jZXNzIHRyYW5zZmVycyB3aXRoaW4gNTAwbXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCB0cmFuc2ZlckRhdGEgPSB0ZXN0VXRpbHMuZ2VuZXJhdGVUcmFuc2ZlckRhdGEoXG4gICAgICAgIHJlY2lwaWVudFVzZXIuaWQsXG4gICAgICAgICdFVVInLFxuICAgICAgICAxMC4wMFxuICAgICAgKTtcblxuICAgICAgY29uc3QgeyByZXNwb25zZSwgcGFzc2VkIH0gPSBhd2FpdCB0ZXN0VXRpbHMudGVzdFBlcmZvcm1hbmNlKFxuICAgICAgICAnUE9TVCcsXG4gICAgICAgICcvYXBpL3YxL3RyYW5zZmVycy9zZW5kJyxcbiAgICAgICAgNTAwLFxuICAgICAgICBzZW5kZXJVc2VyLFxuICAgICAgICB0cmFuc2ZlckRhdGFcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwYXNzZWQpLnRvQmUodHJ1ZSk7XG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDEpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGhhbmRsZSBjb25jdXJyZW50IHRyYW5zZmVycycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHRyYW5zZmVyRGF0YSA9IHRlc3RVdGlscy5nZW5lcmF0ZVRyYW5zZmVyRGF0YShcbiAgICAgICAgcmVjaXBpZW50VXNlci5pZCxcbiAgICAgICAgJ0VVUicsXG4gICAgICAgIDEuMDBcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlcyA9IGF3YWl0IHRlc3RVdGlscy50ZXN0Q29uY3VycmVuY3koXG4gICAgICAgICdQT1NUJyxcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL3NlbmQnLFxuICAgICAgICA1LCAvLyBMaW1pdCBjb25jdXJyZW50IHRyYW5zZmVycyB0byBhdm9pZCBiYWxhbmNlIGlzc3Vlc1xuICAgICAgICBzZW5kZXJVc2VyLFxuICAgICAgICB0cmFuc2ZlckRhdGFcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXNwb25zZXMpLnRvSGF2ZUxlbmd0aCg1KTtcblxuICAgICAgcmVzcG9uc2VzLmZvckVhY2gocmVzcG9uc2UgPT4ge1xuICAgICAgICAvLyBTb21lIG1heSBzdWNjZWVkLCBzb21lIG1heSBmYWlsIGR1ZSB0byBpbnN1ZmZpY2llbnQgYmFsYW5jZVxuICAgICAgICBleHBlY3QoWzIwMSwgNDAwXSkudG9Db250YWluKHJlc3BvbnNlLnN0YXR1cyk7XG4gICAgICAgIHRlc3RVdGlscy5hc3NlcnRSZXNwb25zZVRpbWUocmVzcG9uc2UsIDEwMDApO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgcmVzcG9uZCBxdWlja2x5IGZvciB0cmFuc2ZlciBoaXN0b3J5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgeyByZXNwb25zZSwgcGFzc2VkIH0gPSBhd2FpdCB0ZXN0VXRpbHMudGVzdFBlcmZvcm1hbmNlKFxuICAgICAgICAnR0VUJyxcbiAgICAgICAgJy9hcGkvdjEvdHJhbnNmZXJzL2hpc3RvcnknLFxuICAgICAgICAyMDAsXG4gICAgICAgIHNlbmRlclVzZXJcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChwYXNzZWQpLnRvQmUodHJ1ZSk7XG4gICAgICB0ZXN0VXRpbHMuYXNzZXJ0U3VjY2Vzc1Jlc3BvbnNlKHJlc3BvbnNlLCAyMDApO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9